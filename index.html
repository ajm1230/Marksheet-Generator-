<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Marksheet Generator</title>
  <style>
  div.button {
      padding: 10px 16px;
      margin: 10px 6px;
      border: none;
      border-radius: 5px;
      background-color: #0056b3;
      color: white;
      font-weight: bold;
      cursor: pointer;
    }
    body { font-family: 'Segoe UI', sans-serif; background-color: #f8f9fa; margin: 0; padding: 20px; text-align: center; }
       button:hover { background-color: #004494; }
    .container { border: 10px solid #e94f4f; border-radius: 10px; padding: 20px; background-color: #fffde7;max-width: 900px;margin: auto; overflow-x: auto; }
    .institution { color: black; font-weight: bold; padding: 10px; font-size: 50px; margin-bottom: 10px; }
    .title-bar { background: #e94f4f; color: white; font-weight: bold; padding: 10px; font-size: 22px; margin-bottom: 10px; }
    .subject-bar { background-color: #2f7048; color: white; padding: 10px; font-size: 18px; margin-bottom: 20px; font-weight: bold;}
    table { width: 100%; border-collapse: collapse; font-size: 16px; min-width: 300px; }
    th, td { font-weight: bold; border: 2px solid #000; padding: 10px; text-align: center; }
    th { font-weight: bold; background-color: #e67700; color: white; }
    td.marks { font-weight: bold; }
    td.sno { background-color: #FDFD96;}
    .editable { background-color: #ffffdd; }
    .delete-hover { cursor: pointer; color: red; }
  </style>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
  <h1>MARKSHEET GENERATOR</h1>
<div class="max-w-xl mx-auto p-6 bg-gray-50 rounded-xl shadow-md">
  <!-- Inputs -->
  <div class="space-y-4">
    <!-- Faculty, Class, Subject, Topic, Total Marks -->
    <div class="flex items-center gap-4"><label for="faculty" class="w-36 font-semibold">FACULTY:</label><input id="faculty" placeholder="Faculty Name" class="flex-1 p-2 border rounded-md"/></div>
    <div class="flex items-center gap-4"><label for="class" class="w-36 font-semibold">CLASS:</label><input id="class" placeholder="Class (e.g. 9th)" class="flex-1 p-2 border rounded-md"/></div>
    <div class="flex items-center gap-4"><label for="subject" class="w-36 font-semibold">SUBJECT:</label><input id="subject" placeholder="Subject (e.g. Mathematics)" class="flex-1 p-2 border rounded-md"/></div>
    <div class="flex items-center gap-4"><label for="topic" class="w-36 font-semibold">TOPIC:</label><input id="topic" placeholder="Topic (e.g. Polynomials)" class="flex-1 p-2 border rounded-md"/></div>
    <div class="flex items-center gap-4"><label for="totalMarks" class="w-36 font-semibold">TOTAL MARKS:</label><input type="number" id="totalMarks" placeholder="Total Marks" class="flex-1 p-2 border rounded-md"/></div>
    <!-- Student Name, Marks, Color -->
    <div class="flex items-center gap-4"><label for="studentName" class="w-36 font-semibold">STUDENT NAME:</label><input id="studentName" placeholder="Student Name" class="flex-1 p-2 border rounded-md"/></div>
    <div class="flex items-center gap-4"><label for="studentMarks" class="w-36 font-semibold">MARKS:</label><input type="number" id="studentMarks" placeholder="Marks Obtained" class="flex-1 p-2 border rounded-md"/></div>
    <div class="flex items-center gap-4"><label for="color1" class="w-36 font-semibold">COLOR:</label><input type="color" id="color1" class="h-10 w-24 border rounded-md" value="#d0f0d0"/></div>
  </div>
  <!-- Buttons -->
  <div class="mt-7 space-y-5">
       <button onclick="addStudent()" class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded shadow-md transition duration-200">
  Add Student
</button>
<button onclick="clearAll" class="bg-red-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded shadow-md transition duration-200">
  Clear All
</button>
<button onclick="downloadMarksheet()" class="bg-blue-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded shadow-md transition duration-200">
  Download Marksheet
</button>
  </div>
</div>
  <div id="marksheet" class="container">
  <div class="text-xl font-bold institution" >EKLAVYA CLASSES</div>
  <div class="title-bar">MARKSHEET</div>
  <div class="subject-bar" id="subjectDisplay"></div>
  <table>
    <thead><tr><th>S.NO.</th><th>STUDENT NAME</th><th>MARKS</th></tr></thead>
    <tbody id="tableBody"></tbody>
  </table>
  <div class="footer" id="facultyDisplay"></div>
</div><script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script><script>
  let students = JSON.parse(localStorage.getItem('students')) || [];
  let totalMarks = localStorage.getItem('totalMarks') || '';
  // save helpers
  const save = ()=> localStorage.setItem('students', JSON.stringify(students));
  const saveAndRender = ()=>{localStorage.setItem('totalMarks', totalMarks); save(); render();};

  function render() {
    const tbody = document.getElementById('tableBody'); tbody.innerHTML = '';
    students.forEach((s, i)=>{
      const row = document.createElement('tr');
      row.draggable = true; row.dataset.index = i;
      // drag events
      row.addEventListener('dragstart', e=> dragIndex = i);
      row.addEventListener('dragover', e=> e.preventDefault());
      row.addEventListener('drop', e=>{ const dropIndex=+row.dataset.index; [students[dragIndex],students[dropIndex]]=[students[dropIndex],students[dragIndex]]; saveAndRender(); });
      // S.No
      const td1 = document.createElement('td'); td1.className='delete-hover'; td1.innerText=i+1;
      td1.style.backgroundColor = "#ffcc99"; // Light red for S.No cell
      td1.onclick=()=>{ if(confirm('Delete this student?')){students.splice(i,1); saveAndRender(); }};
      // Name
      const td2=document.createElement('td'); td2.contentEditable=true; td2.className='editable'; td2.innerText=s.name;
      
      td2.oninput=()=>{ s.name=td2.innerText.trim(); save(); };
      // Marks
      const td3=document.createElement('td'); td3.contentEditable=true; td3.className='editable marks'; td3.innerText=`${s.marks} / ${totalMarks}`;
      td3.style.backgroundColor = s.color;
      td3.oninput=()=>{ let val=td3.innerText.split('/')[0].trim(); if(!isNaN(val)&&+val<=+totalMarks){ s.marks=val; td3.innerText=`${val} / ${totalMarks}`; td3.style.color=s.color; save(); } else { td3.innerText=`${s.marks} / ${totalMarks}`; }};

      [td1,td2,td3].forEach(el=>row.appendChild(el)); tbody.appendChild(row);
    });
    // header & footer
    document.getElementById('facultyDisplay').innerText='FACULTY: '+ (localStorage.getItem('faculty')||'');
    document.getElementById('subjectDisplay').innerHTML =
      `${localStorage.getItem('subject')||''} â€“ CLASS ${localStorage.getItem('class')||''}<br>TOPIC: ${localStorage.getItem('topic')||''}`;
    document.getElementById('totalMarks').value = totalMarks;
  }

  // add
  function addStudent(){
    const name=document.getElementById('studentName').value.trim();
    const marks=document.getElementById('studentMarks').value.trim();
    const total=document.getElementById('totalMarks').value.trim();
    const color=document.getElementById('color1').value;
    if(!name||!marks||isNaN(marks)||+marks>+total) return alert('Enter valid details.');
    totalMarks=total;
    students.push({name,marks, color});
    saveAndRender();
    ['studentName','studentMarks'].forEach(id=>document.getElementById(id).value='');
  }

  function clearAll(){ if(confirm('Clear all data?')){ students=[]; totalMarks=''; localStorage.clear(); render(); }}

  // persistent inputs
  ['class','topic','subject','faculty'].forEach(id=>{
    const inp=document.getElementById(id);
    inp.value=localStorage.getItem(id)||'';
    inp.oninput=_=>{ localStorage.setItem(id, inp.value); render(); };
  });

  // download
  function downloadMarksheet(){ html2canvas(document.getElementById('marksheet')).then(canvas=>{ const link=document.createElement('a'); link.download='marksheet.png'; link.href=canvas.toDataURL(); link.click(); }); }

  let dragIndex = null;
  render();
</script></body>
</html>
